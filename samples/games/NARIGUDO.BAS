10 OPEN "grp:" FOROUTPUTAS #1
20 KEY OFF:SCREEN 0:COLOR 2,0,0
30 DIM B(12,7),C(80),F(80)
40 SP=.25:NI=1:RE=0:VI=3
50 CLS:LOCATE 10,4
60 PRINT "* N A R I G U D O *"
70 LOCATE 0,10
80 PRINT "O objetivo  deste jogo ‚  pintar todos"
90 PRINT "os cubos sem ser atingido pelas pedras"
100 PRINT "e monstros.Para movimentar o Narigudo,"
110 PRINT "use um  dos  joysticks ou as teclas de"
120 PRINT "controle do cursor."
130 GOSUB 2620
140 SCREEN 2,3:GOSUB 1820:GOSUB 1900:GOSUB 1980:GOSUB 2060:GOSUB 2140:GOSUB 2220:GOSUB 2300:GOSUB 2380:GOSUB 2460:GOSUB 2540
150 CLS:PRESET(50,15):PRINT #1,"Narigudo:":PUT SPRITE 0,(170,0),10,1
160 PRESET(50,60):PRINT #1,"Monstro:":PUT SPRITE 1,(170,40),13,2
170 PRESET(50,95):PRINT #1,"Pedra:":PUT SPRITE 2,(170,75),6,3
180 PRESET(50,130):PRINT #1,"Elevador:":PUT SPRITE 3,(170,117),12,4
190 PRESET(40,175):PRINT #1,"Aperte o bot±o de tiro"
200 PRESET(40,185):PRINT #1," ou a barra de espa‡o"
210 GOSUB 2620
220 RESTORE:FOR Z=1 TO 7:FOR Z1=0 TO 12
230 READ B(Z1,Z):NEXT Z1,Z
240 GOSUB 2660:REM In¡cio
250 CLS:Z1=0:FOR Z=190 TO 40 STEP-26
260 FOR Z3=50+Z1*15 TO 200-Z1*15 STEP 30
270 LINE(Z3,Z)-(Z3,Z-18),4:LINE-(Z3+15,Z-27),4
280 LINE -(Z3,Z-36),4:LINE-(Z3-15,Z-27),4:LINE-(Z3,Z-18),4
290 LINE-(Z3,Z),4:LINE-(Z3+15,Z-9),4:LINE-(Z3+15,Z-27),4
300 LINE(Z3,Z)-(Z3-15,Z-9),4:LINE-(Z3-15,Z-27),4
310 PAINT(Z3+1,Z-5),4
320 NEXT:Z1=Z1+1:NEXT
330 ZZ=12:GOSUB 2790
340 X=6:Y=1:D=1
350 GOSUB 1700
360 J=7:K=2:J1=.5:K1=-.5:K2=1.5
370 PUT SPRITE 2,(25+J*14,4+(K-1)*26),6,3
380 G=6:H=5:G1=0:H1=0
390 PUT SPRITE 1,(25+G*14,4+(H-1)*26),13,2
400 PUT SPRITE 4,(200,120),12,5
410 PUT SPRITE 3,(18,120),12,4
420 IF X<>INT(X) OR Y<>INT(Y) THEN GOSUB 830
430 IF K1=1 THEN 1570
440 IF SQ=21 THEN 1270
450 LINE  (45,0)-(95,40),1,BF:LINE(222,0)-(250,40),1,BF
460 IF RE<SC THEN RE=SC
470 PRESET(10,10):PRINT #1,"Pts:";SC
480 PRESET(172,30):PRINT #1,"Vidas:";VI
490 PRESET(172,10):PRINT #1,"N¡vel:";NI
500 PRESET(10,30):PRINT #1,"Rec:";RE
510 FOR I%=0 TO 2
520 ST%=STICK(I%):IF ST% THEN I%=2
530 NEXT I%
540 IF ST%<>0 THEN GOSUB 830
550 IF K1=1 THEN 1570
560 PUT SPRITE 2,(25+J*14,4+(K-1)*26),6,3
570 IF K=INT(K) AND K1=1.5 AND J=INT(J) THEN J1=INT(3*RND(-TIME))-1:J1=J1/2:K1=-.5:K2=K-.5
580 IF K<>INT(K) THEN PLAY "V15O3A"
590 IF J1=0 THEN J1=-.5
600 IF J=X AND K=Y THEN GOSUB 1410
610 IF K1=1 THEN 1570
620 J=J+J1:K=K+K1:IF K=K2 THEN K1=1.5
630 IF K=7 THEN FOR QW=1 TO 10:PUT SPRITE 2,(25+J*14,4+QW+(K-1)*26),6,3:NEXT QW:K=1:J=6:K2=.5
640 PUT SPRITE 2,(25+J*14,4+(K-1)*26),6,3
650 PUT SPRITE 1,(25+G*14,4+(H-1)*26),13,2:REM Monstro
660 IF G<>INT(G) OR H<>INT(H) THEN 780
670 IF G<X THEN G1=SP
680 IF G>X THEN G1=-SP
690 IF H>Y THEN H1=-SP
700 IF H<Y THEN H1=SP
710 IF H=Y OR G=X THEN G1=0:H1=0
720 IF G=X AND H<Y THEN H1=SP:G1=(INT(3*RND(-TIME))-1)*SP:IF G1=0 THEN G1=SP
730 IF G=X AND H>Y THEN H1=-SP:G1=(INT(3*RND(-TIME))-1)*SP
740 IF G1=0 THEN G1=-SP
750 IF H=Y AND G<X THEN G1=SP:H1=(INT(3*RND(-TIME))-1)*SP:IF H1=0 OR H+H1>6 THEN H1=-SP
760 IF H=Y AND G>X THEN G1=-SP:H1=(INT(3*RND(-TIME))-1)*SP
770 IF H1=0 OR H+H1>6 THEN H1=-SP
780 G=G+G1:H=H+H1
790 PUT SPRITE 1,(25+G*14,4+(H-1)*26),13,2
800 IF X=G AND Y=H THEN GOSUB 1410
810 IF K1=1 THEN 1570
820 GOTO 420
830 IF X<>INT(X) OR Y<>INT(Y) THEN GOSUB 1700:REM Movimento do Narigudo
840 IF ST%=1 THEN X1=-.5:Y1=-.5:D=9
850 IF ST%=7 THEN D=9:X1=-.5:Y1=.5
860 IF ST%=3 THEN D=1:X1=.5:Y1=-.5
870 IF ST%=5 THEN X1=.5:Y1=.5:D=1
880 X=X+X1:Y=Y+Y1
890 IF X=INT(X) OR Y=INT(Y) THEN X1=0:Y1=0
900 PLAY "V15L8O4F"
910 IF X=INT(X) AND B(X,Y)=1 THEN GOSUB 1000:CIRCLE(35+X*15,33+(Y-1)*26.3),4,15,,,.5:PAINT(35+X*15,33+(Y-1)*26.3),15:SQ=SQ+1:B(X,Y)=0:GOSUB 1700:GOSUB 1000:NN=1:GOSUB 1730
920 IF SQ=21 THEN RETURN
930 IF X=INT(X) AND Y=INT(Y) AND B(X,Y)=4 THEN GOSUB 1030:NN=-1:GOSUB 1730:IF B(6,1)=1 THEN CIRCLE(125,33),4,15,,,.5:PAINT(125,33),15:SQ=SQ+1:B(6,1)=0
940 IF X=INT(X) AND Y=INT(Y) AND B(X,Y)=5 THEN GOSUB 1160:NN=-1:GOSUB 1730:IF B(6,1)=1 THEN CIRCLE(125,33),4,15,,,.5:PAINT(125,33),15:SQ=SQ+1:B(6,1)=0
950 IF X=INT(X) AND Y=INT(Y) AND B(X,Y)=3 THEN GOSUB 1480:IF K1=1 THEN RETURN
960 IF(J=X AND K=Y) OR (G=X AND H=Y) THEN GOSUB 1410:IF K1=1 THEN RETURN
970 IF Y<1 THEN Y=1:X=6:X1=0:Y1=0
980 GOSUB 1700
990 RETURN
1000 PUT SPRITE 2,(25+J*14,4+(K-1)*26),6,3:REM Pedra/Monstro
1010 PUT SPRITE 1,(25+G*14,4+(H-1)*26),13,2
1020 RETURN
1030 GOSUB 2670:REM Elevador da direita
1040 ZZ=0:GOSUB 2790
1050 Z1=5:FOR Z=11 TO 6 STEP-.25
1060 GOSUB 1720
1070 PUT SPRITE 4,(Z*11+56,Z1*18+8),12,5
1080 Z3=6-Z1
1090 GOSUB 1720
1100 PUT SPRITE 4,(Z*11+56,Z1*18+8),12,5
1110 Z1=Z1-.25:NEXT
1120 PUT SPRITE 4,(200,120),12,5
1130 BEEP
1140 ZZ=12:GOSUB 2790
1150 X=6:Y=1:RETURN
1160 GOSUB 2670:REM Elevador da esquerda
1170 Z1=5:FOR Z=0 TO 5 STEP.25
1180 PUT SPRITE 0,(30+Z*17,15+(Z1-1)*18),10,D
1190 PUT SPRITE 3,(Z*17+27,Z1*18+8),12,4
1200 Z3=6-Z1
1210 PUT SPRITE 0,(30+Z*17,15+(Z1-1)*18),10,D
1220 PUT SPRITE 3,(Z*17+27,Z1*18+8),12,4
1230 Z1=Z1-.25:NEXT
1240 PUT SPRITE 3,(18,5*26-10),12,4
1250 BEEP
1260 X=6:Y=1:RETURN
1270 PLAY "T200L4V12":REM Sobe de n¡vel
1280 PLAY "O4CDEFGAB"
1290 PLAY "O5CDEFGAB"
1300 PLAY "O6CDEFGABO7C"
1310 CLS:GOSUB 2660:FOR Z2=2 TO 6 STEP 2
1320 Z=13:Z1=10
1330 FOR Z3=1 TO 9
1340 LINE(128-Z,100-Z1)-(128+Z,100+Z1),Z2,B
1350 Z=Z+13:Z1=Z1+8
1360 NEXT:NEXT
1370 SC=SC+NI*1000:NI=NI+1
1380 IF NI>2 THEN SP=.5
1390 IF NI>7 THEN SP=1
1400 SQ=0:COLOR 3,0:TS=TS+21:GOTO 220
1410 GOSUB 1700:REM Perde vida
1420 PLAY "V15O4A"
1430 PUT SPRITE 0,(25+X*14,4+(Y-1)*26),10,D+5:FOR HH=1 TO 300:NEXT HH:PUT SPRITE 0,(25+X*14,4+(Y-1)*26),0,D+5
1440 PLAY "O5A"
1450 PUT SPRITE 0,(25+X*14,4+(Y-1)*26),10,D+6:FOR HH=1 TO 300:NEXT HH:PUT SPRITE 0,(25+X*14,4+(Y-1)*26),0,D+6
1460 PUT SPRITE 0,(25+X*14,4+(Y-1)*26),10,8:GOSUB 2750:PUT SPRITE 0,(25+X*14,4+(Y-1)*26),0,8
1470 K1=1:RETURN
1480 Z=Y:Y1=0:IF X<6 THEN X1=-.12 ELSE X1=.12:REM Borda
1490 IF X<6 THEN X=X-.5 ELSE X=X+.5
1500 IF Z>7 THEN Z=7
1510 Z=Z+Y1:X=X+X1:Y1=Y1+.03
1520 SOUND 7,56:SOUND 8,15
1530 FOR HH=1 TO 3:SOUND 1,Z+HH/8:NEXT HH
1540 PUT SPRITE 0,(25+X*14,4+(Z-1)*26),10,D
1550 IF Z>7 THEN K1=1:SOUND 8,0:RETURN
1560 GOTO 1500
1570 VI=VI-1:IF VI<0 THEN 1580 ELSE 340:REM Fim de jogo
1580 GOSUB 2660
1590 CLS:IF SC>RE THEN RE=SC
1600 TS=TS+SQ:PRESET(10,0):PRINT #1,"Recorde:";RE
1610 PRESET(10,20):PRINT #1,"Vocˆ fez";SC;"pontos."
1620 PRESET(10,40):PRINT #1,"Vocˆ pintou";TS;"cubos."
1630 PRESET(10,60):PRINT #1,"Vocˆ estava no n¡vel ";MID$(STR$(NI),2)"."
1640 PRESET(10,80):PRINT #1,"Quer jogar de novo (S/N)?"
1650 Z$=INPUT$(1):REM Sim/n±o
1660 Z$=CHR$(ASC(Z$) AND 223)
1670 IF Z$="" OR (Z$<>"S" AND Z$<>"N") THEN 1650
1680 IF Z$="S" THEN SC=0:NI=1:SQ=0:TS=0:SP=.25:K1=0:VI=3:GOTO 220
1690 GOTO 1810
1700 IF X<>INT(X) OR Y<>INT(Y) THEN PUT SPRITE 0,(25+X*(14+SGN(X1)),4+(Y-1.8)*26),10,D:RETURN:REM Posi‡±o do Narigudo
1710 PUT SPRITE 0,(25+X*14,4+(Y-1)*26),10,D:RETURN
1720 PUT SPRITE 0,(14+(Z+1)*14,15+(Z1-1)*18),10,D:RETURN:REM Subida do Narigudo
1730 SC=SC+NN*100*NI:RETURN:REM Contagem de pontos
1740 DATA 3,3,3,3,3,3,1,3,3,3,3,3,3
1750 DATA 3,3,3,3,3,1,0,1,3,3,3,3,3
1760 DATA 3,3,3,3,1,0,1,0,1,3,3,3,3
1770 DATA 3,3,3,1,0,1,0,1,0,1,3,3,3
1780 DATA 5,3,1,0,1,0,1,0,1,0,1,3,4
1790 DATA 3,1,0,1,0,1,0,1,0,1,0,1,3
1800 DATA 3,3,3,3,3,3,3,3,3,3,3,3,3
1810 END
1820 RESTORE 1820:REM Narigudo
1830 B$=""
1840 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
1850 SPRITE$(1)=B$:RETURN
1860 DATA 0,3,7,14,15,15,15,15
1870 DATA 7,3,3,3,3,3,3,0
1880 DATA 0,0,128,192,248,248,248,192
1890 DATA 128,0,0,0,0,224,224,0
1900 RESTORE 1900:REM Narigudo para a esquerda
1910 B$=""
1920 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
1930 SPRITE$(9)=B$:RETURN
1940 DATA 0,0,1,2,31,31,31,3
1950 DATA 1,0,0,0,0,7,7,0
1960 DATA 0,192,224,112,240,240,240,240
1970 DATA 224,192,192,192,192,192,192,0
1980 RESTORE 1980:REM Monstro
1990 B$=""
2000 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2010 SPRITE$(2)=B$:RETURN
2020 DATA 2,7,5,7,4,0,7,7
2030 DATA 15,31,31,15,15,7,3,1
2040 DATA 0,0,128,128,128,136,204,198
2050 DATA 195,131,135,142,252,252,252,252
2060 RESTORE 2060:REM Pedra
2070 B$=""
2080 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2090 SPRITE$(3)=B$:RETURN
2100 DATA 0,0,0,0,0,0,3,7
2110 DATA 15,31,31,31,31,15,7,3
2120 DATA 0,0,0,0,0,0,192,224
2130 DATA 240,248,248,248,248,240,224,192
2140 RESTORE 2140:REM Elevador
2150 B$=""
2160 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2170 SPRITE$(4)=B$:SPRITE$(5)=B$:RETURN
2180 DATA 0,0,0,0,0,15,63,225
2190 DATA 255,63,15,0,0,0,0,0
2200 DATA 0,0,0,0,0,240,252,255
2210 DATA 255,252,240,0,0,0,0,0
2220 RESTORE 2220:REM Narigudo amassado 1
2230 B$=""
2240 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2250 SPRITE$(6)=B$:RETURN
2260 DATA 0,0,0,0,0,0,0,3
2270 DATA 7,7,7,7,1,1,1,1
2280 DATA 0,0,0,0,0,0,0,224
2290 DATA 160,248,248,224,128,128,192,192
2300 RESTORE 2300:REM Nariguro amassado 2
2310 B$=""
2320 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2330 SPRITE$(7)=B$:RETURN
2340 DATA 0,0,0,0,0,0,0,0
2350 DATA 0,0,7,7,7,7,1,1
2360 DATA 0,0,0,0,0,0,0,0
2370 DATA 0,0,224,160,240,128,0,128
2380 RESTORE 2380:REM Narigudo amassado 3
2390 B$=""
2400 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2410 SPRITE$(8)=B$:RETURN
2420 DATA 0,0,0,0,16,8,5,3
2430 DATA 7,7,3,5,8,16,0,0
2440 DATA 0,0,192,176,200,16,160,192
2450 DATA 224,224,192,160,16,136,192,0
2460 RESTORE 2460:REM Narigudo amassado 4
2470 B$=""
2480 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2490 SPRITE$(14)=B$:RETURN
2500 DATA 0,0,0,0,0,0,0,7
2510 DATA 5,31,31,7,1,1,3,3
2520 DATA 0,0,0,0,0,0,0,192
2530 DATA 224,224,224,224,128,128,128,128
2540 RESTORE 2540:REM Narigudo amassado 5
2550 B$=""
2560 FOR I=1 TO 32:READ A:B$=B$+CHR$(A):NEXT I
2570 SPRITE$(15)=B$:RETURN
2580 DATA 0,0,0,0,0,0,0,0
2590 DATA 0,0,7,5,15,1,0,1
2600 DATA 0,0,0,0,0,0,0,0
2610 DATA 0,0,224,224,224,224,128,128
2620 LOCATE 8,20:PRINT "Aperte o bot±o de tiro"
2630 LOCATE 9,21:PRINT "ou a barra de espa‡o"
2640 IF STRIG(0)=0 AND STRIG(1)=0 AND STRIG(2)=0 THEN GOTO 2640
2650 RETURN
2660 PUT SPRITE 0,(250,40),1,1:PUT SPRITE 1,(250,40),1,2:PUT SPRITE 2,(250,40),1,3:PUT SPRITE 3,(250,40),1,4:PUT SPRITE 4,(250,40),1,5:RETURN
2670 RESTORE 2670:REM Som elevador
2680 FOR KK=0 TO 13
2690 READ DT
2700 SOUND KK,DT
2710 NEXT KK
2720 RETURN
2730 DATA 0,0,100,3,24,0,16
2740 DATA 1,0,16,16,90,2,12
2750 SOUND 7,56:SOUND 1,4:REM Som monstro/pedra
2760 FOR K=15 TO 10 STEP -1
2770 SOUND 8,K:FOR L=1 TO 100:NEXT L:NEXT K
2780 BEEP:RETURN
2790 LINE(208,141)-(224,142),ZZ,BF
2800 LINE(204,139)-(228,140),ZZ,BF
2810 LINE(200,137)-(232,138),ZZ,BF
2820 LINE(200,135)-(232,136),ZZ,BF
2830 LINE(204,133)-(228,134),ZZ,BF
2840 LINE(208,131)-(224,132),ZZ,BF
2850 RETURN
