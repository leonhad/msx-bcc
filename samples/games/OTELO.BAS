10 DIM T(9,9),TT(8,8),DX(7),DY(7),CA(7,1),ME$(2,1),SC(9,9)
20 ON INTERVAL=60 GOSUB 690
30 RESTORE 50:FOR A=0 TO 9:FOR B=0 TO 9:T(A,B)=4:NEXT B,A
40 FOR A=0 TO 7:READ DX(A),DY(A):NEXT A
50 DATA 0,-1,1,-1,1,0,1,1,0,1,-1,1,-1,0,-1,-1
60 FOR A=1 TO 2:FOR B=0 TO 1:READ ME$(A,B):NEXT B,A
70 DATA " Sua vez ","Minha vez"
80 DATA " Brancas"," Pretas "
90 FOR A=1 TO 4:FOR B=1 TO 8:READ C:SC(A,B)=C:SC(9-A,B)=C
100 NEXT B,A
110 DATA 16,-4,4,2,2,4,-4,16,-4,-12,-2,-2,-2,-2,-12,-4
120 DATA 4,-2,4,2,1,4,-2,4,2,-2,2,0,0,2,-2,2
130 GOSUB 1060
140 GOSUB 960:J=0:GOSUB 990:NT=0
150 GOSUB 250
160 IF NJ=2 OR J=0 THEN 180
170 GOSUB 410:GOSUB 530:IF JS=-50 THEN 230 ELSE GOSUB 810:GOTO 220
180 GOSUB 420:IF BA=0 THEN 230 ELSE GOSUB 410
190 GOSUB 1790
200 GOSUB 810
210 IF BA=0 THEN GOSUB 650:GOSUB 1800:GOTO 200
220 ND=0:GOSUB 730:NT=0
230 NT=NT+1:IF NT=3 THEN GOTO 340
240 J=1-J:GOTO 150
250 P1=0:P2=0:FOR A=1 TO 8:FOR B=1 TO 8
260 IF T(A,B)=0 THEN P1=P1+1
270 IF T(A,B)=1 THEN P2=P2+1
280 NEXT B:NEXT A:PT=P1+P2
290 LOCATE 21,2:PRINT "BRANCAS":LOCATE 21,7:PRINT "PRETAS"
300 LOCATE 0,20:PRINT SPACE$(40)
310 LOCATE 0,21:PRINT SPACE$(40)
320 LOCATE 22,4:PRINT P1:LOCATE 22,9:PRINT P2
330 RETURN
340 GOSUB 250
350 IF P1=P2 THEN LOCATE 6,0:PRINT "EMPATOU!":GOTO 380
360 IF P1>P2 THEN LOCATE 0,0:PRINT "GANHARAM AS BRANCAS!":GOTO 380
370 IF P1<P2 THEN LOCATE 1,0:PRINT "GANHARAM AS PRETAS!":GOTO 380
380 A$="Quer jogar de novo? ":AS$="S":AN$="N":GOSUB 1040:IF RE=1 THEN GOTO 30 ELSE STOP
390 XX$=INKEY$:IF XX$="" THEN 390
400 GOTO 30
410 LOCATE 20,12:PRINT ME$(NJ,J);:RETURN
420 FOR TX=1 TO 8:FOR TY=1 TO 8
430 GOSUB 810
440 IF BA=1 THEN TX=9:TY=9
450 NEXT TY,TX
460 RETURN
470 BS=-20:FOR TX=1 TO 8:FOR TY=1 TO 8
480 GOSUB 810:NS=SC(TX,TY)
490 IF BA=0 THEN GOTO 510
500 IF NS>BS OR NS=BS AND RND(-TIME)>.5 THEN BS=NS
510 NEXT TY,TX
520 RETURN
530 INTERVAL ON:JS=-50:ND=1:FOR TX=1 TO 8:FOR TY=1 TO 8
540 GOSUB 810:IF BA=0 THEN 620
550 FOR Q=1 TO 8:FOR R=1 TO 8:TT(Q,R)=T(Q,R):NEXT R,Q
560 GOSUB 730:FS=SC(TX,TY):IF PT>58 THEN FS=FS+F1*5
570 QX=TX:QY=TY:IF DI=2 THEN J=0:GOSUB 470:J=1
580 TX=QX:TY=QY:FOR Q=1 TO 8:FOR R=1 TO 8:T(Q,R)=TT(Q,R):NEXT R,Q
590 IF DI=1 THEN BS=0:GOTO 610
600 IF PT>58 THEN BS=BS+F1*5
610 IF FS-BS>JS OR (FS-BS>JS AND RND(-TIME)>.5) THEN JS=FS-BS:GX=TX:GY=TY
620 NEXT TY,TX:TX=GX:TY=GY
630 IF (TX=1 OR TX=8) AND (TY=1 OR TY=8) THEN FOR A=0 TO 6 STEP 2:SC(TX+DX(A),TY+DY(A))=8:NEXT A
640 INTERVAL OFF:LOCATE 22,15:PRINT SPC(3):LOCATE 22,16:PRINT SPC(3):RETURN
650 PLAY "o4v15l30ababab":RETURN
660 PLAY "o5v15l64c":RETURN
670 PLAY "o5v15l64g":RETURN
680 PLAY "o6v15l64g":RETURN
690 W=W+1:IF W>2 THEN W=1
700 LOCATE 22,15
710 IF W=1 THEN PRINT STRING$(3,209):LOCATE 22,16:PRINT STRING$(3,209):RETURN
720 IF W=2 THEN PRINT STRING$(3,210):LOCATE 22,16:PRINT STRING$(3,210):RETURN
730 F1=0:X=TX:Y=TY:GOSUB 900
740 FOR A=0 TO 7
750 IF CA(A,0)=0 THEN 800
760 X=TX+DX(A):Y=TY+DY(A)
770 FOR B=1 TO CA(A,1)
780 GOSUB 900:X=X+DX(A):Y=Y+DY(A)
790 NEXT B
800 NEXT A:RETURN
810 Q=1-J:BA=0:IF T(TX,TY)<>4 THEN RETURN
820 FOR A=0 TO 7:CA(A,0)=0
830 IF T(TX+DX(A),TY+DY(A))<>Q THEN 890
840 SX=TX+DX(A):SY=TY+DY(A):CT=0
850 CT=CT+1:SX=SX+DX(A):SY=SY+DY(A)
860 IF T(SX,SY)=4 THEN 890
870 IF T(SX,SY)=J THEN BA=1:CA(A,0)=1:CA(A,1)=CT:GOTO 890
880 GOTO 850
890 NEXT A:RETURN
900 FL=FL+1:T(X,Y)=J:IF ND=1 THEN RETURN
910 PX=2*X:PY=2*Y
920 IF J=0 THEN C$="A"
930 IF J=1 THEN C$="B"
940 GOSUB 1680:GOSUB 660
950 RETURN
960 ND=0:FOR X=4 TO 5:Y=X:J=0:GOSUB 900:NEXT X
970 J=1:X=4:Y=5:GOSUB 900:X=5:Y=4:GOSUB 900
980 RETURN
990 A$="N£mero de jogadores":AS$="1":AN$="2":GOSUB 1040:NJ=RE
1000 IF NJ=2 THEN RETURN
1010 A$="Escolha o n¡vel    ":AS$="F cil":AN$="Dif¡cil":GOSUB 1040:DI=RE
1020 A$="Quer jogar primeiro?":AS$="S":AN$="N":GOSUB 1040:J=RE-1
1030 RETURN
1040 LOCATE 1,20:PRINT A$:LOCATE 2,21:PRINT AS$;SPC(4):LOCATE 10,21:PRINT AN$;SPC(6)
1050 GOSUB 1550:RETURN
1060 SCREEN 1,0,0
1070 KEY OFF
1080 RESTORE 1170
1090 FOR CH=182 TO 200
1100 FOR N=0 TO 7
1110 READ Z
1120 VPOKE 8*CH+N,Z
1130 NEXT N
1140 NEXT CH
1150 VPOKE &H2016,31:VPOKE &H2017,31
1160 GOTO 1360
1170 DATA 255,128,128,159,144,144,144,144
1180 DATA 255,1,1,249,9,9,9,9
1190 DATA 9,9,9,9,249,1,1,255
1200 DATA 144,144,144,144,159,128,128,255
1210 DATA 255,128,128,159,159,159,159,159
1220 DATA 255,1,1,249,249,249,249,249
1230 DATA 249,249,249,249,249,1,1,255
1240 DATA 159,159,159,159,159,128,128,255
1250 DATA 255,255,255,255,255,255,255,255
1260 DATA 255,128,128,128,128,128,128,128
1270 DATA 255,1,1,1,1,1,1,1
1280 DATA 128,128,128,128,128,128,128,255
1290 DATA 1,1,1,1,1,1,1,255
1300 DATA 0,0,15,16,32,35,36,36
1310 DATA 0,0,240,8,4,196,36,36
1320 DATA 36,36,35,32,16,15,0,0
1330 DATA 36,36,196,4,8,240,0,0
1340 DATA 0,0,255,0,0,255,0,0
1350 DATA 36,36,36,36,36,36,36,36
1360 CLS
1370 COLOR 1,2,2
1380 FOR A=8214 TO 8217:VPOKE A,31:NEXT A
1390 VPOKE 8218,242
1400 FOR X=2 TO 17
1410 LOCATE X,1:PRINT CHR$(199)
1420 LOCATE X,18:PRINT CHR$(199)
1430 NEXT X
1440 FOR Y=2 TO 17
1450 LOCATE 1,Y:PRINT CHR$(200)
1460 LOCATE 18,Y:PRINT CHR$(200)
1470 NEXT Y
1480 LOCATE 1,1:PRINT CHR$(195)
1490 LOCATE 18,1:PRINT CHR$(196)
1500 LOCATE 1,18:PRINT CHR$(197)
1510 LOCATE 18,18:PRINT CHR$(198)
1520 FOR Y=2 TO 16 STEP 2:FOR X=2 TO 16 STEP 2:LOCATE X,Y:PRINT CHR$(191);CHR$(192):NEXT X:NEXT Y
1530 FOR Y=3 TO 17 STEP 2:FOR X=2 TO 16 STEP 2:LOCATE X,Y:PRINT CHR$(193);CHR$(194):NEXT X:NEXT Y
1540 RETURN
1550 PP=0
1560 IF STICK(0)=7 OR STICK(1)=7 THEN PP=0
1570 IF STICK(0)=3 OR STICK(1)=3 THEN PP=1
1580 IF PP=0 THEN GOSUB 1660
1590 IF PP=1 THEN GOSUB 1670
1600 IF STRIG(0)=0 AND STRIG(1)=0 THEN 1560
1610 RE=PP+1
1620 IF STRIG(0)=-1 OR STRIG(1)=-1 THEN 1620
1630 IF PP=0 THEN GOSUB 670
1640 IF PP=1 THEN GOSUB 680
1650 RETURN
1660 LOCATE 1,21:PRINT ">";AS$:LOCATE 9,21:PRINT " ":RETURN
1670 LOCATE 9,21:PRINT ">";AN$:LOCATE 1,21:PRINT " ":RETURN
1680 LOCATE PX,PY
1690 IF C$="A" THEN PRINT CHR$(182);CHR$(183)
1700 IF C$="B" THEN PRINT CHR$(186);CHR$(187)
1710 IF C$="C" THEN PRINT CHR$(190);CHR$(190)
1720 IF C$="D" THEN PRINT CHR$(191);CHR$(192)
1730 LOCATE PX,PY+1
1740 IF C$="A" THEN PRINT CHR$(185);CHR$(184)
1750 IF C$="B" THEN PRINT CHR$(189);CHR$(188)
1760 IF C$="C" THEN PRINT CHR$(190);CHR$(190)
1770 IF C$="D" THEN PRINT CHR$(193);CHR$(194)
1780 RETURN
1790 PX=2:PY=2
1800 IF STRIG(0)=-1 OR STRIG(1)=-1 OR STRIG(2)=-1 THEN GOTO 1900
1810 C$="C":GOSUB 1680
1820 C$="D":GOSUB 1680
1830 IF T(PX/2,PY/2)=0 THEN C$="A":GOSUB 1680
1840 IF T(PX/2,PY/2)=1 THEN C$="B":GOSUB 1680
1850 IF (STICK(0)=3 OR STICK(1)=3 OR STICK(2)=3) AND PX<15 THEN PX=PX+2
1860 IF (STICK(0)=7 OR STICK(1)=7 OR STICK(2)=7) AND PX>3 THEN PX=PX-2
1870 IF (STICK(0)=1 OR STICK(1)=1 OR STICK(2)=1) AND PY>3 THEN PY=PY-2
1880 IF (STICK(0)=5 OR STICK(1)=5 OR STICK(2)=5) AND PY<15 THEN PY=PY+2
1890 GOTO 1800
1900 TX=PX/2:TY=PY/2:RETURN
